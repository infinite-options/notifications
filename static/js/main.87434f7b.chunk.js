(this.webpackJsonpnotifications=this.webpackJsonpnotifications||[]).push([[0],{41:function(e,t,a){e.exports=a(61)},46:function(e,t,a){},61:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(9),s=a.n(i),o=(a(46),a(38)),c=a(28),l=a(11),d=a(12),u=a(15),h=a(14),p=a(63),f=a(64),m=a(65),g=a(24),v=a.n(g),w=a(29),S=a(30),b=(a(59),a(60),function(e){Object(u.a)(a,e);var t=Object(h.a)(a);function a(e){var n;Object(l.a)(this,a),(n=t.call(this,e)).resize=function(){n.setState({height:window.innerWidth>=990?window.innerHeight-32:500})},n.kitchenMap=new Map;var r=[{field:"",headerCheckboxSelection:!0,checkboxSelection:!0,headerCheckboxSelectionFilteredOnly:!0,width:50},{headerName:"Name",field:"name"},{headerName:"Email",field:"email"},{headerName:"Phone",field:"phone"},{headerName:"Address",field:"address"},{headerName:"City",field:"city"},{headerName:"Zip Code",field:"zipCode"},{headerName:"Kitchen",field:"kitchen"},{headerName:"# Orders",field:"n_orders"},{headerName:"Created",field:"first_order"},{headerName:"Last Order",field:"last_order"}];return r.forEach((function(e){switch(e.field&&(e.sortable=!0),e.suppressMovable=!0,e.filterParams={buttons:["apply","reset"]},e.field){case"":break;case"n_orders":e.filter="agNumberColumnFilter";break;case"first_order":case"last_order":e.filter="agDateColumnFilter",e.filterParams.comparator=function(e,t){var a=t.split("-"),n=parseInt(a[2]),r=parseInt(a[1])-1,i=parseInt(a[0]);return new Date(i,r,n).compareTo(e)};break;default:e.filter=!0}})),n.state={columnDefs:r,rowData:[],height:window.innerWidth>=900?window.innerHeight-32:500},n}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=Object(w.a)(v.a.mark((function e(){var t,a=this;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(this.props.api,"/kitchens"));case 2:return t=e.sent,e.next=5,t.json();case 5:e.sent.result.forEach((function(e){a.kitchenMap.set(e.kitchen_id.S,e.kitchen_name.S)})),fetch("".concat(this.props.api,"/all_orders")).then((function(e){return e.json().then((function(e){var t=[];e.Items.forEach((function(e){t.push({name:e.name.S,email:e.email.S,phone:e.phone.S,address:e.street.S,city:e.city.S,kitchen:a.kitchenMap.get(e.kitchen_id.S),zipCode:e.zipCode.N,n_orders:e.number_of_orders.S,first_order:e.created_at.S.slice(0,10),last_order:e.last_order_date.S.slice(0,10)})})),t.forEach((function(e){e.zipCode=parseInt(e.zipCode),e.n_orders=parseInt(e.n_orders)})),a.setState({rowData:t})}))}));case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"ag-theme-alpine",style:{height:"".concat(this.state.height,"px")}},r.a.createElement(S.AgGridReact,{onGridReady:function(t){return e.gridApi=t.api},onSelectionChanged:this.props.updateValidity,columnDefs:this.state.columnDefs,rowData:this.state.rowData,defaultColDef:{resizable:!0},suppressSizeToFit:!0,groupSelectsFiltered:!0,groupUseEntireRow:!0,rowSelection:"multiple"}))}}]),a}(r.a.Component)),y=function(e){Object(u.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).getMsg=function(){return n.text.current.value},n.resize=function(){n.setState({height:window.innerWidth>=990?window.innerHeight-96:150})},n.text=r.a.createRef(),n.state={height:window.innerWidth>=990?window.innerHeight-96:150},n}return Object(d.a)(a,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("textarea",{ref:this.text,className:"w-100 p-3",style:{height:"".concat(this.state.height,"px")},placeholder:"Enter message here",onInput:this.props.updateValidity}),r.a.createElement("br",null))}}]),a}(r.a.Component),E=a(68),k=a(66),C=a(67),x=function(e){Object(u.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).openGroups=function(){n.setState({showGroups:!0})},n.closeGroups=function(){n.setState({showGroups:!1})},n.state={groups:[],showGroups:!1},n}return Object(d.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement(p.a,{className:"d-flex justify-content-around p-3"},r.a.createElement(E.a,{variant:"secondary",onClick:this.openGroups},"Saved groups"),r.a.createElement(E.a,{variant:"secondary",onClick:this.props.send,disabled:!this.props.msgValid||!this.props.selectionValid},"Send Message"),r.a.createElement(E.a,{variant:"secondary",onClick:this.props.sendAll,disabled:!this.props.msgValid},"Send To All"),r.a.createElement(k.a,{show:this.state.showGroups,onHide:this.closeGroups,centered:!0},r.a.createElement(k.a.Header,{closeButton:!0},r.a.createElement(k.a.Title,null,"Saved Groups")),r.a.createElement(k.a.Body,null,this.state.groups.length?r.a.createElement(C.a,null,this.state.groups.map((function(t){return r.a.createElement(C.a.Item,{onClick:function(){return e.props.select(t.nodes)},action:!0,key:t.name},t.name)}))):"No saved groups"),r.a.createElement(k.a.Footer,null,r.a.createElement(E.a,{variant:"secondary",onClick:this.props.save,disabled:!this.props.selectionValid},"Save new group"),r.a.createElement(E.a,{variant:"secondary",onClick:this.closeGroups},"Close"))))}}]),a}(r.a.Component),O=function(e){Object(u.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).sendMsg=function(){if(n.readyToSend()){var e,t=n.recipients.current.gridApi.getSelectedNodes(),a=[],r=Object(c.a)(t);try{for(r.s();!(e=r.n()).done;){var i=e.value,s="email_".concat(i.data.email.toLowerCase());-1===a.indexOf(s)&&a.push(s)}}catch(l){r.e(l)}finally{r.f()}var o=new FormData;o.append("tags",a.join(",")),o.append("message",n.text.current.getMsg()),fetch("".concat(n.state.api,"/send_notification"),{method:"POST",body:o}),n.setState({msgValid:!1}),alert("Message sent successfully")}},n.sendAll=function(){if(n.text.current.getMsg()){var e=new FormData;e.append("tags","default"),e.append("message",n.text.current.getMsg()),fetch("".concat(n.state.api,"/send_notification"),{method:"POST",body:e}),n.setState({msgValid:!1}),alert("Message sent successfully")}},n.updateValidity=function(){n.setState({msgValid:""!==n.text.current.getMsg(),selectionValid:n.recipients.current.gridApi.getSelectedNodes().length>0})},n.readyToSend=function(){return n.recipients.current.gridApi.getSelectedNodes().length&&n.text.current.getMsg()},n.select=function(e){var t=!0;e.forEach((function(e){e.selected||(t=!1),e.setSelected(!0)})),t&&e.forEach((function(e){e.setSelected(!1)}))},n.saveGroup=function(){if(n.state.selectionValid){var e=n.recipients.current.gridApi.getSelectedNodes(),t=prompt("Enter group name:");if(t.length){var a={name:t,nodes:e};n.saved.current.setState({groups:[].concat(Object(o.a)(n.saved.current.state.groups),[a])})}}},n.resize=function(){n.text.current.resize(),n.recipients.current.resize()},n.recipients=r.a.createRef(),n.text=r.a.createRef(),n.saved=r.a.createRef(),n.state={api:"https://phaqvwjbw6.execute-api.us-west-1.amazonaws.com/dev/api/v1",msgValid:!1,selectionValid:!1},window.onresize=n.resize,n}return Object(d.a)(a,[{key:"render",value:function(){return r.a.createElement(p.a,{fluid:!0,className:"h-100 pt-3 pl-3 pr-3 pb-0"},r.a.createElement(f.a,{className:"d-flex"},r.a.createElement(m.a,{lg:8,className:"mb-3"},r.a.createElement(b,{ref:this.recipients,api:this.state.api,updateValidity:this.updateValidity})),r.a.createElement(m.a,{lg:4},r.a.createElement(y,{ref:this.text,send:this.sendMsg,ready:this.readyToSend,updateValidity:this.updateValidity}),r.a.createElement(x,{ref:this.saved,select:this.select,save:this.saveGroup,send:this.sendMsg,sendAll:this.sendAll,msgValid:this.state.msgValid,selectionValid:this.state.selectionValid}))))}}]),a}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(O,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[41,1,2]]]);
//# sourceMappingURL=main.87434f7b.chunk.js.map